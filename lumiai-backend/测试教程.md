# LumiAI 前后端联调测试教程

## 📋 测试前准备

### 1. 确认环境配置

#### 后端配置
1. 打开文件：`d:\CUHKSZ\书院\D\lumiai-backend\.env`
2. 确认已填入 Gemini API Key：
   ```
   GEMINI_API_KEY=你的真实API密钥
   ```
3. 如果刚修改，需要重启后端服务

#### 检查依赖
- 后端：确保已运行 `pip install -r requirements.txt`
- 前端：确保已运行 `npm install`

---

## 🚀 启动服务

### 步骤 1：启动后端服务

打开终端 1，执行：
```powershell
cd d:\CUHKSZ\书院\D\lumiai-backend
.\venv\Scripts\activate
python -m uvicorn app.main:app --reload --port 8000
```

**预期输出**：
```
INFO:     Uvicorn running on http://127.0.0.1:8000
INFO:     Application startup complete.
```

### 步骤 2：启动前端服务

打开终端 2，执行：
```powershell
cd d:\CUHKSZ\书院\D\lumiai
npm run dev
```

**预期输出**：
```
VITE v6.4.1  ready in 300 ms
➜  Local:   http://localhost:3000/
```

---

## ✅ 测试清单

### 测试 1：后端健康检查

1. 打开浏览器，访问：http://localhost:8000/api/health
2. **预期结果**：
   ```json
   {"status": "ok", "message": "LumiAI Backend is running"}
   ```

### 测试 2：API 文档验证

1. 访问：http://localhost:8000/docs
2. **预期结果**：看到 Swagger UI 界面，包含以下模块：
   - 认证 (3 个端点)
   - 题库 (4 个端点)
   - 练习 (4 个端点)
   - 分析 (6 个端点)
   - 生词本 (5 个端点)
   - AI对话 (2 个端点)

### 测试 3：获取题目数据

在 Swagger UI 中：
1. 找到 `GET /api/questions`
2. 点击 "Try it out"
3. 点击 "Execute"
4. **预期结果**：返回题目列表（包含阅读、听力等题目）

### 测试 4：前端页面加载

1. 访问：http://localhost:3000
2. **预期结果**：
   - 看到精美的首页动画
   - 粒子背景效果
   - "开始你的雅思之旅" 按钮

### 测试 5：AI 对话功能 ⭐ 核心测试

1. 在前端页面点击 "开始" 进入仪表盘
2. 找到右下角的浮动 AI 助手按钮（圆形头像）
3. 点击打开对话窗口
4. 输入测试消息：`你好，请介绍一下你自己`
5. 点击发送
6. **预期结果**：
   - ✅ 收到 Lumina 的自我介绍（中文回复）
   - ✅ 对话历史正常显示

**如果失败**：
- 检查浏览器控制台（F12）是否有错误
- 确认后端终端是否显示 API 调用日志
- 确认 API Key 是否正确配置

### 测试 6：题库功能

在 Swagger UI 中测试：

#### 6.1 随机抽题
- 端点：`GET /api/questions/random?category=reading`
- **预期**：返回一道阅读题（包含文章和问题）

#### 6.2 题目统计
- 端点：`GET /api/questions/count`
- **预期**：返回各类别题目数量

### 测试 7：练习流程

在 Swagger UI 中按顺序测试：

#### 7.1 创建练习会话
- 端点：`POST /api/practice/sessions`
- 请求体：
  ```json
  {
    "category": "reading",
    "title": "测试练习"
  }
  ```
- **预期**：返回 session_id

#### 7.2 提交答案
- 端点：`POST /api/practice/sessions/{session_id}/submit`
- 请求体：
  ```json
  {
    "question_id": 1,
    "user_answer": "wrong answer"
  }
  ```
- **预期**：返回正确答案和 AI 分析（如果答错）

#### 7.3 查看练习历史
- 端点：`GET /api/practice/history`
- **预期**：返回练习记录列表

### 测试 8：学情分析

#### 8.1 技能雷达图
- 端点：`GET /api/analysis/skills`
- **预期**：返回 6 项技能得分数据

#### 8.2 学习统计
- 端点：`GET /api/analysis/stats`
- **预期**：返回时长统计和正确率数据

#### 8.3 个性化推荐
- 端点：`GET /api/analysis/recommendations`
- **预期**：返回推荐练习列表

### 测试 9：生词本功能

#### 9.1 添加生词
- 端点：`POST /api/vocabulary`
- 请求体：
  ```json
  {
    "word": "hazardous",
    "definition": "dangerous",
    "part_of_speech": "adj"
  }
  ```

#### 9.2 查看生词本
- 端点：`GET /api/vocabulary`
- **预期**：返回刚添加的生词

### 测试 10：前端完整流程

1. **首页** → 点击开始
2. **仪表盘** → 查看学习概览
3. **练习室** → 点击 "阅读 (Reading)" 卡片
4. **模拟考试界面** → 查看题目展示
5. **返回** → 点击左上角返回箭头
6. **学情分析** → 查看雷达图和统计图表
7. **设置** → 切换深色模式
8. **AI 助手** → 多轮对话测试

---

## 🐛 常见问题排查

| 问题 | 排查步骤 | 解决方案 |
|------|---------|----------|
| AI 无响应 | 1. 检查 `.env` 文件<br>2. 查看后端日志 | 填入正确的 API Key |
| CORS 错误 | 检查后端是否运行 | 确保后端在 8000 端口 |
| 前端白屏 | 1. 检查浏览器控制台<br>2. 查看终端错误 | 重新 `npm install` |
| 后端启动失败 | 查看错误信息 | 检查 Python 版本和依赖 |
| 数据库错误 | 检查是否有 `lumiai.db` | 删除后重启，会自动创建 |

---

## 📊 测试报告模板

完成测试后，可以用以下格式记录：

```
测试时间：2026-01-14
测试人员：[你的名字]

✅ 通过的测试：
- [ ] 后端健康检查
- [ ] API 文档加载
- [ ] 题目数据获取
- [ ] 前端页面加载
- [ ] AI 对话功能
- [ ] 练习流程
- [ ] 学情分析
- [ ] 生词本功能

❌ 失败的测试：
- [记录失败项和错误信息]

📝 备注：
[其他观察和建议]
```

---

## 🎯 Demo 演示建议

如果要进行产品演示，推荐流程：

1. **开场**（30秒）：展示首页动画和品牌介绍
2. **核心功能**（2分钟）：
   - AI 对话：展示智能导师功能
   - 阅读练习：展示题目交互
3. **数据可视化**（1分钟）：展示学情分析页面
4. **特色功能**（30秒）：深色模式、粒子效果

**重点突出**：AI 智能分析和个性化推荐

---

## 📞 需要帮助？

如果测试过程中遇到问题：
1. 记录错误信息（截图或复制文本）
2. 检查后端终端和浏览器控制台的日志
3. 将错误信息发给我，我会帮你排查
